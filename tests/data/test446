<?xml version="1.0" encoding="ISO-8859-1"?>
<testcase>
<info>
<keywords>
HTTP
HTTP proxy
HSTS
trailing-dot
</keywords>
</info>

<reply>

# we use this as response to a CONNECT
<connect nocheck="yes">
HTTP/1.1 200 OK

</connect>
<data crlf="yes">
HTTP/1.1 200 OK
Content-Length: 6
Strict-Transport-Security: max-age=604800

-foo-
</data>
<data2 crlf="yes">
HTTP/1.1 200 OK
Content-Length: 6
Strict-Transport-Security: max-age=6048000

-baa-
</data2>
</reply>

<client>
<server>
https
http-proxy
</server>
<features>
HSTS
proxy
https
debug
</features>
<setenv>
CURL_HSTS_HTTP=yes
CURL_TIME=2000000000
</setenv>

<name>
HSTS with two URLs
</name>
<command>
-x http://%HOSTIP:%PROXYPORT --hsts %LOGDIR/hsts%TESTNUMBER http://this.hsts.example./%TESTNUMBER http://another.example.com/%TESTNUMBER0002
</command>
</client>

<verify>
# we let it CONNECT to the server to confirm HSTS but deny from there
<proxy crlf="yes">
GET http://this.hsts.example./%TESTNUMBER HTTP/1.1
Host: this.hsts.example.
User-Agent: curl/%VERSION
Accept: */*
Proxy-Connection: Keep-Alive

GET http://another.example.com/%TESTNUMBER0002 HTTP/1.1
Host: another.example.com
User-Agent: curl/%VERSION
Accept: */*
Proxy-Connection: Keep-Alive

</proxy>

<file name="%LOGDIR/hsts%TESTNUMBER" mode="text">
# Your HSTS cache. https://curl.se/docs/hsts.html
# This file was generated by libcurl! Edit at your own risk.
this.hsts.example "20330525 03:33:20"
another.example.com "20330727 03:33:20"
</file>

</verify>
</testcase>
