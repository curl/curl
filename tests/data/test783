<testcase>
<info>
<keywords>
HTTP
HTTP proxy
HSTS
</keywords>
</info>

<reply>

# we use this as response to a CONNECT
<connect nocheck="yes">
HTTP/1.1 200 OK
Server: fake

</connect>

<data nocheck="yes">
HTTP/1.1 200 OK
Date: Tue, 09 Nov 2010 14:49:00 GMT
Server: test-server/fake swsclose
Content-Type: text/html
Funny-head: yesyes
Strict-Transport-Security: max-age=1000;

</data>
</reply>

<client>
<server>
http
http-proxy
https
</server>
<features>
HSTS
proxy
https
Debug
large-time
</features>

<setenv>
CURL_HSTS_HTTP=yes
CURL_TIME=1728465947
</setenv>

<file name="%LOGDIR/input%TESTNUMBER">
.hsts.example "20991001 04:47:41"
.this.hsts.example "99991001 04:47:41"
</file>

<name>
HSTS update expiry, removing includesubdomains in update
</name>
<command>
-x http://%HOSTIP:%PROXYPORT http://this.hsts.example:%HTTPSPORT/%TESTNUMBER --hsts %LOGDIR/input%TESTNUMBER -k
</command>
<disable>
test-duphandle
</disable>
</client>

<verify>

<stdout>
HTTP/1.1 200 OK
Server: fake

HTTP/1.1 200 OK
Date: Tue, 09 Nov 2010 14:49:00 GMT
Server: test-server/fake swsclose
Content-Type: text/html
Funny-head: yesyes
Strict-Transport-Security: max-age=1000;

</stdout>

<file name="%LOGDIR/input%TESTNUMBER" mode="text">
# Your HSTS cache. https://curl.se/docs/hsts.html
# This file was generated by libcurl! Edit at your own risk.
.hsts.example "20991001 04:47:41"
this.hsts.example "20241009 09:42:27"
</file>
</verify>
</testcase>
